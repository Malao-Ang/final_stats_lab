# -*- coding: utf-8 -*-
"""stats_final_lab14.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1y808Yh_9QSQ8KD-oDMGj6sPr493zeDzg

**อย่าลืม Save a copy in drive ก่อนนะคะ**

จงเขียนโปรแกรมเพื่อหาค่าที่โจทย์ต้องการและแสดงผลลัพธ์ออกทางหน้าจอ

1. 	ในการสำรวจความต้องการที่อยู่อาศัยของประชาชนในชุมชนแห่งหนึ่ง สุ่มประชาชน
1,000 คน พบว่า 485 คน ต้องการมีที่อยู่เป็นของตนเองในเขตเทศบาล 

  1.1 จงหาค่าประมาณแบบจุด
ของสัดส่วนของประชาชนที่ต้องการที่อยู่อาศัยในเขตเทศบาล 

  1.2  จงหาค่าประมาณแบบจุด
ของสัดส่วนของประชาชนที่ไม่ต้องการที่อยู่อาศัยในเขตเทศบาล
 
  1.3 จงหาช่วงความเชื่อมั่น 99% ของสัดส่วนของประชาชนที่ต้องการที่อยู่อาศัยในเขตเทศบาล

  1.4 จากการสำรวจของเทศบาลเชื่อว่ามีมากกว่า 60% ของประชาชนที่ต้องการที่อยู่อาศัยในเขตเทศบาล จงทดสอบว่าการสำรวจของเทศบาลเชื่อถือได้หรือไม่ที่ระดับความเชื่อมั่น 95%

  1.5 เทศบาลเชื่อว่ามี  30% ของประชาชนที่ต้องการที่อยู่อาศัยในเขตเทศบาล จงทดสอบว่าความเชื่อของเทศบาลเป็นจริงหรือไม่ที่ระดับความเชื่อมั่น 90%



2. จากการสำรวจความพึงพอใจการใช้เครื่องปรับอากาศยี่ห้อหนึ่งของพ่อบ้านกับแม่บ้าน
ในชุมชนที่มีครอบครัวอาศัยอยู่ 300 ครอบครัว โดยสุ่มตัวอย่างมา 36 ครอบครัว พบว่ามีพ่อบ้าน
และแม่บ้านที่พึงพอใจเครื่องปรับอากาศยี่ห้อดังกล่าวจำนวน 9 คน และ 12 คน ตามลำดับ 

2.1 จงหา
ค่าประมาณแบบจุดของผลต่างระหว่างสัดส่วนของความพึงพอใจเครื่องปรับอากาศของพ่อบ้านและ
แม่บ้าน และสรุปว่าฝ่ายใดมีความพอใจมากกว่าฝ่ายใด เท่ากับเท่าใด

2.2 จงหาช่วงความเชื่อมั่น 90% ของผลต่างระหว่างสัดส่วนของความพึงพอใจเครื่องปรับอากาศของพ่อบ้านและ
แม่บ้าน และสรุปว่าฝ่ายใดมีความพอใจมากกว่าฝ่ายใด ตั้งแต่เท่าใดถึงเท่าใด

2.3 จงทดสอบว่าสัดส่วนความพึงพอใจเครื่องปรับอากาศของพ่อบ้านและ
แม่บ้านแตกต่างกันหรือไม่ ที่ระดับนัยสำคัญ 0.05

2.4 จงทดสอบว่าสัดส่วนความพึงพอใจเครื่องปรับอากาศของพ่อบ้านมากกว่า
แม่บ้านจริงหรือไม่ ที่ระดับนัยสำคัญ 0.05
"""

#1.1 จงหาค่าประมาณแบบจุด ของสัดส่วนของประชาชนที่ต้องการที่อยู่อาศัยในเขตเทศบาล
from statsmodels.stats.proportion import proportion_confint

nobs = 1000
count1 = 485
print('P1 = %.4f'%(count/nobs))
#1.2 จงหาค่าประมาณแบบจุด ของสัดส่วนของประชาชนที่ไม่ต้องการที่อยู่อาศัยในเขตเทศบาล
count2 = 1000-485
print('P2 = %.4f'%(count2/nobs))
#1.3 จงหาช่วงความเชื่อมั่น 99% ของสัดส่วนของประชาชนที่ต้องการที่อยู่อาศัยในเขตเทศบาล
alpha = 0.01
L,U = proportion_confint(count,nobs,alpha)
print('L = %.4f U = %.4f'%(L,U))

"""ตอบ ข้อ 1

ค่าประมารแบบจุดของสัดส่วนประชากรที่ต้องการอาศัยอยู่ในเขตเทศบาลเท่ากับ 0.4850 คิดเป็น 48.5%
ค่าประมาณแบบจุด ของสัดส่วนของประชาชนที่ไม่ต้องการที่อยู่อาศัยในเขตเทศบาลเท่ากับ 0.5150 คิดเป็นเปอร์เซ็นคือ 51.50%
ช่วงความเชื่อมั่น 99% ของสัดส่วนของประชาชนที่ต้องการที่อยู่อาศัยในเขตเทศบาล = 0.4442909 ถึง 0.5257091
"""

#1.4  จากการสำรวจของเทศบาลเชื่อว่ามีมากกว่า 60% ของประชาชนที่ต้องการที่อยู่อาศัยในเขตเทศบาล จงทดสอบว่าการสำรวจของเทศบาลเชื่อถือได้หรือไม่ที่ระดับความเชื่อมั่น 95%
from statsmodels.stats.proportion import binom_test
alpha  = 0.05
null_hypothesis = 0.6
nobs = 1000
count = 485
p_value = binom_test(count,nobs,null_hypothesis,alternative = 'larger')
print('P-value = %.4f'%(p_value))
if p_value > alpha:
  print('Accept null hypothesis')
else:
  print('Reject null hypothesis')

"""ตอบ 1.4 ค่า p-valueมากกว่าระดับนัยสำคัญ ยอมรับH0 แสดงว่า P >= 0.60 ดังนั้นที่ระดับนัยสำคัญ 0.05 ผลสรุปของเทศบาลเชื่อถือไม่ได้"""

#1.5เทศบาลเชื่อว่ามี 30% ของประชาชนที่ต้องการที่อยู่อาศัยในเขตเทศบาล จงทดสอบว่าความเชื่อของเทศบาลเป็นจริงหรือไม่ที่ระดับความเชื่อมั่น 90%
from statsmodels.stats.proportion import  binom_test
alpha = 0.1
null_hypothesis = 0.30
nobs = 1000
count = 485
p_value = binom_test(count,nobs,null_hypothesis,alternative='two-sided')
print('P-value = %.4f'%(p_value))

if p_value > alpha:
  print('Accept null hypothesis')
else:
  print('Reject null hypothesis')

"""ตอบ 1.5 ค่า p-value น้อยกว่าหรือเท่ากับระดับนัยสำคัญ0.1 ผลสรุปของเทศบาลเชื่อถือไม่ได้"""

#2.1 จงหา ค่าประมาณแบบจุดของผลต่างระหว่างสัดส่วนของความพึงพอใจเครื่องปรับอากาศของพ่อบ้านและ แม่บ้าน และสรุปว่าฝ่ายใดมีความพอใจมากกว่าฝ่ายใด เท่ากับเท่าใด
from statsmodels.stats.proportion import proportion_confint
from math import sqrt
from scipy.stats import norm
import numpy as np
alpha = 0.05
count1 = 9
nobs1 = 36
count2 = 12
nobs2 = 36
p1 = count1/nobs1
p2 = count2/nobs2
z = norm.ppf(1-alpha/2)
print('z = %.7f'%(z))
#2.2 จงหาช่วงความเชื่อมั่น 90% ของผลต่างระหว่างสัดส่วนของความพึงพอใจเครื่องปรับอากาศของพ่อบ้านและ แม่บ้าน และสรุปว่าฝ่ายใดมีความพอใจมากกว่าฝ่ายใด ตั้งแต่เท่าใดถึงเท่าใด
alpha = 0.1
print('L =',(p1-p2) -(z*(sqrt((p1*(1-p1))/nobs1+(p2*(1-p2))/nobs2))))
print('U =',(p1-p2) +(z*(sqrt((p1*(1-p1))/nobs1+(p2*(1-p2))/nobs2))))

"""ตอบ 2

ค่าประมาณแบบจุดของผลต่างระหว่างสัดส่วนของความพึงพอใจเครื่องปรับอากาศของพ่อบ้านและ แม่บ้าน พ่อบ้านคือ 0.25 หรือ 25% แม่บ้าน 0.33 หรือ 33% และสรุปว่าพ่อบ้านพอใจมากกว่าแม่บ้านอยู่ 0.083หรือ 0.83%
ช่วงความเชื่อมั่น 90% ของผลต่างระหว่างสัดส่วนของความพึงพอใจเครื่องปรับอากาศของพ่อบ้านและ แม่บ้าน อยุ่ในช่วง -0.2588 ถึง 0.09214 หมายความว่าสัดส่วนของพี่บ้านที่พึงพอใจน้อยกว่าแม่บ้าน 0.2588 หรือมากกว่าแม่บ้าน 0.0921
"""

#2.3จงทดสอบว่าสัดส่วนความพึงพอใจเครื่องปรับอากาศของพ่อบ้านและ แม่บ้านแตกต่างกันหรือไม่ ที่ระดับนัยสำคัญ 0.05
from scipy.stats import norm
from math import sqrt
count1 = 9
nobs1 = 36
count2 = 12
nobs2 = 36
alpha = 0.05
p1 = count1/nobs1
p2 = count2/nobs2
z = norm.ppf(1-alpha/2)
print('p1 =',p1,', p2 =',p2)
print('p1 - p2 =',p1-p2)
print('z =',z)

"""ตอบ 2.3 สัดส่วนความพึงพอใจเครื่องปรับอากาศของพ่อบ้านและ แม่บ้านแตกต่างกัน 0.833 ดังนั้น แม่บ้านมีความพึงพอใจมากวว่าหรือเท่ากับพ่อบ้าน ที่ระดับนัยสำคัญ 0.05"""

#2.4  จงทดสอบว่าสัดส่วนความพึงพอใจเครื่องปรับอากาศของพ่อบ้านมากกว่า แม่บ้านจริงหรือไม่ ที่ระดับนัยสำคัญ 0.05
'''H1: พ่อ > แม่
H0: พ่อ <=แม่ '''
from statsmodels.stats.proportion import proportions_ztest
import pandas as pd
data = pd.DataFrame({
"x1": [9,12],
"x2": [27,24] })

significance = 0.05
stat,p = proportions_ztest(count = data.x1,nobs = data.sum(axis = 1),value=0,alternative='smaller', prop_var=False)
print("stat = %0.5f, p-value = %0.7f" % (stat, p))
if p > significance:
  print("we are accepting null hypothesis")
else:
  print("we are rejecting null hypothesis")

"""ตอบ 2.4 ค่าp-value มากกว่าค่าสถิติ ดังนั้นยอมรับ H0 P1-P2 <= 0 หมายความว่า ความพึงพอใจเครื่องปรับอากาศของพ่อบ้านมากกว่าแม่บ้านไม่เป็นความจริงที่ระดับนัยสำคัญ 0.05 สัดส่วนความพึงพอใจของแม่บ้านมีค่ามากกว่าหรือเท่ากับพ่อบ้าน"""

